.. _commit-push-publish-page:

Commit Pull Push Publish
========================

Общее
-----

* Все экшены пишутся в один лог :ref:`class-log-page`.
* Уйти от 16-тиричной нумерации версий ?

Commit
------

Cоздание локальной версии.

* место хранения ``work`` директория, определяется в *set studio*, метод ``studio.set_work_folder()``

Pull
----

Загрузка *push* версии в локальную *work* директорию.

* Нумерация версий общая с *commit*.

.. rubric:: Работник студии:

* Заливка из локального сервера студии.

.. rubric:: Аутсорс:

* Заливка из временного файла облака. 
* Требуется предварительная загрузка в облако менеджером. 
* Удаляется из облака после выполнения *pull*
* Скетч:
    * Заливаются все ветки, каждая в свою новую версию по порядку. 
* Не скетч:
    * Заливается в новую версию.

Push
----

Создание версии на сервере.

* операция не создаёт новый *commit*
* для **sketch** - сразу создавать *png*
* загружается последняя или кастомная версия указанной ветки из **work**
    * для **sketch** - только последние версии всех веток подлежащих пушингу.
* проверка на совпадение с последней *push* версией по атрибуту ``source``
    * для **sketch** - проверка на совпадение по всем версиям последнего пуша.
* место хранения в ``project/assets``
* нумерация отличается от *commit* (своя параллельная нумерация).
* атрибут ``source`` - локальная версия откуда был *push*
    * для **sketch:** - список версий по каждой ветки откуда пуш, порядок совпадает с порядком записи наименований веток в ``branch``
* ``branch`` - соответствует локальному.
    * для **sketch:** - список передаваемых веток.

Файловая структура:
*******************

* Файлы в директориях версий:
    * ``asset_name.ext`` (для всех что не *sketch*)
    * ``asset_name#branch_name.ext`` (для *sketch*)
    * ``asset_name#branch_name.png`` (для *sketch*) - создавать тут для облегчения просмтотров, в паблише лишь перезапись.

Publish
-------

Публикация финальной версии на сервере.

* последняя или по выбору *push* версия
* нумерация отличается от *push* (своя параллельная нумерация).
* атрибут ``source`` - номер *push* версии
* атрибут ``branch`` - записывается из *push*
* самостоятельное выполнение, не связанное с приёмом задачи.
* приёмка задачи не запускает *publish*

Файловая структура:
*******************

* Сверху файлы последней версии:
    * ``asset_name.ext`` (для всех что не *sketch*)
    * ``asset_name#branch_name.ext`` (для *sketch*)
    * ``asset_name#branch_name.png`` (для *sketch*)
* Директории:
    * ``version_num`` - содержат весь набор файлов версии.
